---
theme: small_steps
title: 实例引导的设计
kata: shopping_basket
difficulty: 1
author: emilybache
---
# 实例引导的设计

这可以成为[红色步骤中的设计](design_with_a_test.html)之后的一个很好的后续。

## 学习目标

* 认识到需求规格和实例之间的区别
* 将一个详细的实例变成一个测试 case

## 会议大纲

* 5分钟的连接：需求规格与实例
* 10分钟的概念练习：把一个例子变成一个测试用例
* 5分钟的概念：实例引导的设计
* 30分钟的实战练习：购物车
* 5分钟的总结：它是如何工作的，接下来你会怎么做？

### 连接 - 规格与实例
将这些项目写在笔记或卡片上。请大家把它们分成两部分--是规则还是例子？

- 如果你的购物车的总价值超过200元，就给予10%的折扣。
- 你的购物车里最多允许有 100 件物品。
- 如果你的购物车包含3个打印机墨盒（每个50元），5支笔（每支2元），5个记事本（每个10元），你应该得到10%的折扣。
- 如果你的购物车包含1个打印机墨盒（每个50元），5支笔（每支2元），3个记事本（每本10元），你应该总共支付90元。
- 如果你的购物车包含1个打印机墨盒（每个50元），5支笔（每支2元），5个记事本（每个10元），你应该得到5%的折扣。
- 总价是每种物品的单价乘以数量之和。
- 购物车报告应该列出你购物车里的所有物品。
- 当你的购物车是空的时候，购物车报告就不应该出现。
- 当你的购物车里有一个打印机墨盒和一些笔时，报告应该显示这些项目：打印机墨盒，笔。

### 概念练习：将实例转换为测试用例
展示[购物车Kata](/kata_descriptions/shopping_basket.html)的描述。该描述包括一个例子。这个例子可以转化为一个测试用例。你可以在不实现使测试通过的代码的情况下做到这一点。分成两组，要求人们把这个特定的例子变成测试用例中的代码。要求他们不要实现代码--只是让所有的东西都是红色的，不要编译。

给人们10分钟的时间来完成这一部分，或者直到你看到他们已经创建了一个测试案例。要求他们进行截图，并通过共享在线文档或白板与大家分享他们的测试。

审查所有的代码，并对任何差异进行评论。希望你能从不同的小组中得到各种各样的设计。学习要点--在同样的例子中，有不止一种方法来设计代码

如果他们用 float 来表示钱，那么不要强调太多。你可以向他们展示如何用有公差的 assertEquals 做近似的比较。你也可以解释说，浮点数不是一个很好的货币模型，建议他们使用一个整数，让所有的价格以分代替元。

### 概念解释：例子引导的设计
从一个具体的例子出发，可以帮助你想出一个更好的设计。在你实现它之前使用这个东西。它可以帮助你把注意力集中在界面上，使其易于使用，而不是你将如何写出里面的详细代码。

你可能需要几个例子来展示新代码可能需要用到的所有各种情况。从比较简单的例子开始。

### 具体练习：购物车
练习使用例子来建立功能。回去在[购物车Kata](/kata_descriptions/shopping_basket.html)上再写一些代码。然而，不要一开始就实现你刚想出来的测试。先注释掉他。

在你们分成两组进行Kata工作之前，先在整个小组中花几分钟时间想出一个带有简单例子的测试清单，比如：

- 空购物车，0元
- 一件商品，50元
- 两件商品，都是 20元
- 一件商品 50元，一件商品 20元
- 一件商品 160元， 5% 的折扣
- 一件商品 250元，10% 的折扣

当他们做 "Kata"时，试着阻止他们在没有创建测试案例的情况下创建 ShoppingBasket 类 或 Product 类或 calculatePrice 函数。让他们在生产代码中存在之前，练习在测试中使用这些东西。

### 总结：它是如何工作的，为什么会这样？
你是如何使用例子来指导设计的？这样做有什么好处吗？以小组为单位进行讨论。

